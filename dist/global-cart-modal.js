"use strict";(()=>{(function(){let g={DEBUG:!0,CART_KEY:"wf_cart_v3",CHECKOUT_URL:"/deine-bestellung"},h={mens_health:{name:"M\xE4nnergesundheit",basePrice:8743,image:"https://cdn.prod.website-files.com/683eeb6aa2b5e751b457ca93/6949c771d356e1648a13d459_mens_health.jpg",biomarkers:{lh:{name:"LH",price:1457},fsh:{name:"FSH",price:1457},prolactin:{name:"Prolaktin",price:1e3},estradiol:{name:"Estradiol",price:1360},dheas:{name:"DHEAS",price:1360},shbg:{name:"SHBG",price:1749},testosterone:{name:"Testosterone",price:1360},free_testosterone_index:{name:"Free Testosterone Index",price:1e3}}},womens_health:{name:"Frauengesundheit",basePrice:12143,image:"https://cdn.prod.website-files.com/683eeb6aa2b5e751b457ca93/6949c771d356e1648a13d459_womens_health.jpg",biomarkers:{progesterone:{name:"Progesterone",price:1360},estradiol:{name:"Estradiol",price:1360},fsh:{name:"FSH",price:1457},lh:{name:"LH",price:1457},dheas:{name:"DHEAS",price:1360},shbg:{name:"SHBG",price:1749},testosterone:{name:"Testosterone",price:1360},free_testosterone_index:{name:"Free Testosterone Index",price:1e3},ferritin:{name:"Ferritin",price:1457},transferrin:{name:"Transferrin",price:583}}},chronic_inflammation:{name:"Chronische Entz\xFCndung",basePrice:3332,image:"https://cdn.prod.website-files.com/683eeb6aa2b5e751b457ca93/6949c7714515e18a087eaa20_chronic_inflammation.jpg",biomarkers:{hscrp:{name:"hsC-reaktive Protein",price:1166},neutrophile_granulozyten:{name:"Neutrophile Granulozyten",price:1166},interleukin_6:{name:"Interleukin-6",price:1e3}}},iron_metabolism:{name:"Eisen-Metabolismus",basePrice:2873,image:"https://cdn.prod.website-files.com/683eeb6aa2b5e751b457ca93/6949c771d356e1648a13d459_iron_metabolism.jpg",biomarkers:{ferritin:{name:"Ferritin",price:1457},transferrin:{name:"Transferrin",price:583},eisen:{name:"Eisen",price:233},transferrin_saettigung:{name:"Transferrin-S\xE4ttigung",price:600}}},heart_health:{name:"Herzgesundheit",basePrice:4498,image:"https://cdn.prod.website-files.com/683eeb6aa2b5e751b457ca93/6949c771d356e1648a13d459_heart_health.jpg",biomarkers:{apo_b:{name:"APO B",price:2332},hscrp:{name:"hsC-reaktive Protein",price:1166},lpa:{name:"Lp(a)",price:1e3}}},vitamin_b_metabolism:{name:"Vitamin B Stoffwechsel",basePrice:9236,image:"https://cdn.prod.website-files.com/683eeb6aa2b5e751b457ca93/6949c771d356e1648a13d459_vitamin_b.jpg",biomarkers:{vitamin_b2:{name:"Vitamin B2",price:3322},vitamin_b12:{name:"Vitamin B12",price:1457},vitamin_b9:{name:"Vitamin B9 (Fols\xE4ure)",price:1457},vitamin_b6:{name:"Vitamin B6",price:3322}}},vitamin_d:{name:"Vitamin D",basePrice:1865,image:"https://cdn.prod.website-files.com/683eeb6aa2b5e751b457ca93/6949c771d356e1648a13d459_vitamin_d.jpg",biomarkers:{vitamin_d_25oh:{name:"Vitamin D 25OH",price:1865}}},longterm_health:{name:"Longterm Health",basePrice:3964,image:"https://cdn.prod.website-files.com/683eeb6aa2b5e751b457ca93/6949c771d356e1648a13d459_longterm_health.jpg",biomarkers:{hba1c:{name:"HbA1C",price:1166},crp:{name:"CRP",price:1166},alat:{name:"ALAT",price:233},cystatin_c:{name:"Cystatin C",price:1166},ldl:{name:"LDL",price:233}}}},r=(...e)=>g.DEBUG&&console.log("[CART-MODAL]",...e),o=(e,t=document)=>t.querySelector(e),_=(e,t=document)=>[...t.querySelectorAll(e)],P=e=>new Intl.NumberFormat("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e/100),p=()=>{try{return JSON.parse(localStorage.getItem(g.CART_KEY)||"[]")}catch{return[]}},T=e=>{localStorage.setItem(g.CART_KEY,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("cart-updated"))},L=()=>{localStorage.removeItem(g.CART_KEY),window.dispatchEvent(new CustomEvent("cart-updated"))};function A(e){let t=new Map,n=0,d=0,i=[];return e.forEach(a=>{let s=h[a.sku];if(!s)return;let c=s.basePrice;Object.entries(s.biomarkers).forEach(([m,f])=>{t.has(m)?(c-=f.price,d+=f.price):t.set(m,s.name)}),i.push({sku:a.sku,name:s.name,original:s.basePrice,final:c}),n+=c}),{total:n,deductions:d,prices:i,original:e.reduce((a,s)=>{var c;return a+(((c=h[s.sku])==null?void 0:c.basePrice)||0)},0)}}let E=null,C=null,u=null;function k(){return E||(E=o(".cart-modal")),E}function y(){let e=k();if(!e){r("Cart modal not found in DOM");return}e.style.display="flex",setTimeout(()=>{e.style.opacity="1";let t=o(".cart_modal-box",e);t&&(t.style.opacity="1",t.style.transform="translate3d(0rem, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg)")},10),b(),r("Cart modal opened")}function v(){let e=k();if(!e)return;let t=o(".cart_modal-box",e);t&&(t.style.opacity="0",t.style.transform="translate3d(2rem, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg, 0deg)"),setTimeout(()=>{e.style.opacity="0",setTimeout(()=>{e.style.display="none"},200)},100),r("Cart modal closed")}function b(){let e=k();if(!e)return;let t=p(),n=A(t);if(r("Rendering cart modal:",t.length,"items"),u=o(".cart_modal-list",e),!u){r("List container not found");return}if(!C){let i=o(".cart_modal-list_item",u);i&&(C=i.cloneNode(!0),r("Item template initialized"))}if(_(".cart_modal-list_item",u).forEach(i=>i.remove()),t.length===0){let i=document.createElement("li");i.className="cart_modal-list_item",i.innerHTML='<div class="cart_modal-list_item-inner" style="justify-content: center; padding: 2rem;"><div class="text-color-gray-70"><div class="text-size-small">Warenkorb ist leer</div></div></div>',u.appendChild(i)}else C&&t.forEach(i=>{let a=h[i.sku];if(!a)return;let s=n.prices.find(l=>l.sku===i.sku),c=C.cloneNode(!0);c.setAttribute("data-sku",i.sku);let m=o(".cart_modal-list_item_visual img",c);m&&(m.src=a.image,m.alt=a.name,m.removeAttribute("srcset"),m.removeAttribute("sizes"));let f=o(".cart_modal-list_item-text_wrap:not(.is-2)",c);if(f){let l=o(".text-size-small",f);l&&(l.textContent=a.name);let H=o(".text-color-gray-70 .text-size-small",f);H&&(H.textContent=`${Object.keys(a.biomarkers).length} Biomarker`)}let B=o(".cart_modal-list_item-price-wrap",c);if(B){let l=o(".text-size-small",B);l&&(l.textContent=P((s==null?void 0:s.final)||a.basePrice))}let x=o(".cart_modal-list_item-trash",c);x&&(x.style.cursor="pointer",x.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),D(i.sku)})),u.appendChild(c)});let d=o(".cart_modal-price_wrap .heading-style-h4",e);d&&(d.textContent=P(n.total)),_("[data-cart-count]").forEach(i=>{i.textContent=t.length}),r("Cart modal render complete")}function D(e){let t=p().filter(n=>n.sku!==e);T(t),b(),w("Paket entfernt","info"),r("Removed from cart:",e)}function M(e){let t=p();t.find(n=>n.sku===e)||(t.push({sku:e,addedAt:Date.now()}),T(t),w("Paket hinzugef\xFCgt","success")),y()}function w(e,t="info"){if(window.Notification&&typeof window.Notification.show=="function"){window.Notification.show(e,t);return}let n=document.createElement("div");n.style.cssText=`position:fixed;top:20px;right:20px;padding:16px 24px;background:${t==="success"?"#00a86b":t==="error"?"#dc3545":"#333"};color:white;border-radius:8px;z-index:10001;font-size:14px;box-shadow:0 4px 12px rgba(0,0,0,0.15);transition:opacity 0.3s;`,n.textContent=e,document.body.appendChild(n),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>n.remove(),300)},3e3)}function F(){let e=k();if(!e){r("Cart modal not found, skipping setup");return}e.style.display="none",e.style.opacity="0";let t=o(".cart_moda-box_close-button",e);t&&(t.style.cursor="pointer",t.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),v()}),r("Close button initialized"));let n=o(".cart_modal-bg",e);n&&(n.style.cursor="pointer",n.addEventListener("click",a=>{a.preventDefault(),v()}),r("Background click handler initialized"));let d=o(".button.is-link.is-secondary",e);d&&(d.style.cursor="pointer",d.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation(),L(),b(),w("Warenkorb geleert","info")}),r("Clear cart button initialized"));let i=o(".cart_modal-list_item-button_wrap .button:not(.is-secondary)",e);i&&(i.addEventListener("click",a=>{if(a.preventDefault(),a.stopPropagation(),p().length===0){w("Warenkorb ist leer","error");return}window.location.href=g.CHECKOUT_URL}),r("Checkout button initialized")),document.addEventListener("keydown",a=>{a.key==="Escape"&&e.style.display!=="none"&&v()}),r("Cart modal setup complete")}function I(){let e=_('[data-cart-trigger], [data-cart="open"], .cart-icon, .cart-trigger, [href="#cart"]');e.forEach(t=>{t.style.cursor="pointer",t.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),y()})}),r("Cart triggers initialized:",e.length),document.addEventListener("click",t=>{t.target.closest("[data-cart-trigger], [data-open-cart]")&&(t.preventDefault(),t.stopPropagation(),y())})}function z(){let e=p();_("[data-cart-count]").forEach(t=>{t.textContent=e.length})}function S(){r("Initializing global cart modal"),F(),I(),z(),window.addEventListener("cart-updated",()=>{b(),z()}),window.CartModal={open:y,close:v,render:b,getItems:p,clear:L,add:M,remove:D,calculate:A,PACKAGES:h},r("Global cart modal ready. Use CartModal.open() to open.")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S()})();})();
